/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package lab5kotlin

import lab5kotlin.collection.Collection
import lab5kotlin.console.CollectionPrinter
import lab5kotlin.file.FileManager
import lab5kotlin.human.CoordinatesBuilder
import lab5kotlin.human.Human
import lab5kotlin.human.HumanBuilder

class App {
    val greeting: String
        get() {
            return "Hello World!"
        }

    var collection: Collection<Human> = Collection(mutableListOf())
    val fileManager = FileManager(Human.serializer())
    val collectionPrinter = CollectionPrinter()

    fun readFile() {
        this.collection = fileManager.readDumpFile("/Users/dudosyka/IdeaProjects/lab5Kotlin/data.csv")
    }

    fun dumpCollection() {
        fileManager.writeFileDump("/Users/dudosyka/IdeaProjects/lab5Kotlin/data.csv", this.collection)
    }

    fun printCollection() {
        collectionPrinter.print(collection)
    }
}

fun main() {
    val app = App()
    println(app.greeting)
    app.readFile()
    app.printCollection()
    val human = HumanBuilder(
        mutableMapOf(
            "id" to 11900,
            "name" to "Test name",
            "position" to CoordinatesBuilder(mutableMapOf(
                "x" to 1,
                "y" to 2
            )).build()
        )
    )
    app.collection.addItem(human.build())
    app.dumpCollection()
    app.collectionPrinter.printItem(app.collection.getItem(1))
}
